<template>
  <div class="ship__wrapper">
    <div class="circle">
      <div class="ship" ref="ship">
        <svg viewBox="0 0 863 573" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g fill-rule="nonzero" stroke="none" stroke-width="1" fill="none">
              <path d="M0,416 C13.8893229,424.190104 25.2018229,429.376302 33.9375,431.558594 C36.3161632,432.152816 56.4335938,439.664062 90.2929688,442.677734 C112.865885,444.686849 330.082031,444.686849 741.941406,442.677734 C718.64974,442.677734 696.86849,447.722656 676.597656,457.8125 C656.326823,467.902344 639.363281,504.817708 625.707031,568.558594 C373.58991,573.432263 208.967514,563.26169 131.839844,538.046875 C54.7121738,512.83206 10.7655592,472.149768 0,416 Z" fill="#D8D8D8" transform="translate(0 3)"/>
              <path d="M683.5,445 L860.5,445" stroke="#fff" stroke-width="4" stroke-linecap="square" transform="translate(0 3)"/>
              <path d="M596.872124,142.191496 C644.096859,205.997402 670.795887,259.570949 676.969206,302.912136 C683.142525,346.253323 671.380402,397.547698 641.682836,456.795261 C635.607114,438.495237 623.053804,421.649075 604.022905,406.256776 C584.992006,390.864476 565.00719,381.393615 544.068457,377.844194 C583.126804,364.375957 607.813531,334.624664 618.128636,288.590313 C628.443742,242.555962 621.358238,193.756356 596.872124,142.191496 Z" fill="#D8D8D8" transform="rotate(-32 616.5 301)"/>
              <path d="M598.5,401.5 L600,403" stroke="#979797" stroke-linecap="square" transform="translate(0 3)"/>
              <path d="M444.328125,112.09375 C579,231.195312 657.286458,305.85026 679.1875,336.058594 C701.088542,366.266927 718.119792,402.320312 730.28125,444.21875" stroke="#979797" stroke-width="3" transform="translate(0 3)"/>
              <path d="M300.26927,374.658739 L474.459911,409.681694" stroke="#979797" stroke-width="2" fill="#D8D8D8" transform="translate(0 3)"/>
              <path d="M225.916992,55.3671875 C276.829079,105.403646 307.573973,157.088542 318.151674,210.421875 C328.729375,263.755208 321.998872,330.143229 297.960167,409.585937 C252.372702,391.454567 216.591709,379.216937 190.617188,372.873047 C164.642666,366.529157 144.048265,366.529157 128.833984,372.873047 C160.796395,341.306641 188.478449,301.565104 211.880145,253.648438 C235.281841,205.731771 239.96079,139.638021 225.916992,55.3671875 Z M409,66.609375 C458.523415,109.817708 488.573973,158.088542 499.151674,211.421875 C509.729375,264.755208 502.998872,331.143229 478.960167,410.585937 C420.105418,396.613621 381.93673,387.492528 364.454102,383.222656 C346.971473,378.952785 329.105588,376.147121 310.856445,374.805664 C342.137215,342.617513 369.478449,302.565104 392.880145,254.648438 C416.281841,206.731771 421.655126,144.052083 409,66.609375 Z" fill="#D8D8D8" transform="translate(0 3)"/>
              <path d="M297.5,444.5 L269.5,1.5" stroke="#979797" stroke-width="5" stroke-linecap="square" transform="translate(0 3)"/>
              <path d="M478.5,443.5 L450.5,0.5" stroke="#979797" stroke-width="5" stroke-linecap="square" transform="translate(0 3)"/>
              <path d="M271.693359,1 C286.091401,24.0151025 293.786063,44.069139 294.777344,61.1621094 C295.768625,78.2550798 290.297271,98.3091162 278.363281,121.324219 C273.210743,104.173802 268.497201,93.1738021 264.222656,88.3242188 C259.948111,83.4746354 253.873893,79.8639583 246,77.4921875 C258.993376,67.3692575 267.557829,56.1518096 271.693359,43.8398438 C275.82889,31.5278779 275.82889,17.24793 271.693359,1 Z" fill="#D8D8D8" transform="translate(0 3)"/>
              <path d="M451.693359,1 C466.091401,24.0151025 473.786063,44.069139 474.777344,61.1621094 C475.768625,78.2550798 470.920969,103.294793 460.234375,136.28125 C457.98719,111.2975 454.726326,96.3808333 450.451781,91.53125 C446.177236,86.6816667 438.026642,82.0019792 426,77.4921875 C438.993376,67.3692575 447.557829,56.1518096 451.693359,43.8398438 C455.82889,31.5278779 455.82889,17.24793 451.693359,1 Z" fill="#D8D8D8" transform="translate(0 3)"/>
              <path d="M120.26927,371.658739 L294.459911,406.681694" stroke="#979797" stroke-width="2" stroke-linecap="square" transform="translate(0 3)"/>
              <path d="M604.789062,395 L529.980469,444.492188" stroke="#979797" transform="translate(0 3)"/>
            </g>
          </svg>
      </div>
      <div class="waves">
        <svg class="waves-svg" viewBox="0 0 898 357" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <path class="wave-1" ref="wave1" d="M0,71.2109375 C26.1800888,67.9086985 49.6384221,60.135261 70.375,47.890625 C91.1115779,35.645989 107.55689,19.8569265 119.710937,0.5234375 C124.053492,16.3491492 137.295679,32.1382117 159.4375,47.890625 C181.579321,63.6430383 201.456925,71.4164758 219.070313,71.2109375 C252.676063,58.6816674 278.8245,46.8978986 297.515625,35.859631 C316.20675,24.8213634 329.95675,13.0426323 338.765625,0.5234375 C347.028339,16.5988544 365.382506,32.3879169 393.828125,47.890625 C422.273744,63.3933331 447.153952,71.1667706 468.46875,71.2109375 C495.807013,59.3753049 517.491908,47.5915361 533.523438,35.859631 C549.554967,24.1277259 560.067987,12.3489947 565.0625,0.5234375 C564.299802,13.3168031 581.135739,29.1058656 615.570312,47.890625 C650.004886,66.6753844 676.361657,74.4488219 694.640625,71.2109375 C725.405445,56.8372695 748.582528,44.2085988 764.171875,33.3249253 C779.761222,22.4412518 790.334138,11.5074225 795.890625,0.5234375 C792.922648,8.84696292 802.440878,20.7472256 824.445312,36.2242255 C846.449747,51.7012255 870.431518,63.3634628 896.390625,71.2109375 L896.390625,355.671875 L0,355.671875 L0,71.2109375 Z" transform="translate(1)" fill="#020319" fill-rule="nonzero" stroke="#D8D8D8" stroke-width="10"/>
          <path class="wave-2" ref="wave2" d="M0,14.1640625 C34.3385417,14.6484375 58.0234375,20.2734375 71.0546875,31.0390625 C84.0859375,41.8046875 98.4036458,47.1875 114.007813,47.1875 C129.221354,47.671875 143.606771,42.2890625 157.164063,31.0390625 C170.721354,19.7890625 186.286458,10.109375 203.859375,2 C229.375,25.0364583 250.408854,40.0989583 266.960938,47.1875 C283.513021,54.2760417 304.497396,59.4101563 329.914062,62.5898438 C358.919271,63.0872396 380.809896,57.953125 395.585938,47.1875 C410.361979,36.421875 427.898438,21.359375 448.195313,2 C463.622396,14.90625 479.328125,29.96875 495.3125,47.1875 C511.296875,64.40625 533.572917,73.015625 562.140625,73.015625 C586.317708,66.5625 605.882813,57.953125 620.835938,47.1875 C635.789063,36.421875 655.351563,25.4140625 679.523438,14.1640625 C688.278646,29.2291667 697.617188,40.2369792 707.539063,47.1875 C717.460938,54.1380208 743.614583,62.7473958 786,73.015625 C814.302083,66.5625 834.226562,57.953125 845.773438,47.1875 C857.320313,36.421875 874.192708,25.4140625 896.390625,14.1640625 L896.390625,356.789062 L0,356.789062 L0,14.1640625 Z" transform="translate(1 -1)" fill="#020AAA" fill-rule="nonzero" stroke="#4A90E2" stroke-width="1"/>
        </svg>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      changed: false,
      tl: null,
      tl2: null
    }
  },
  methods: {
    removeAnimateClass: function() {
      this.$refs.ship.classList.remove('rotate');
    },
    animateShip: function() {
      this.tl = new TimelineMax({repeat: 2});
      this.tl2 = new TimelineMax({repeat: 1});
      var ship = this.$refs.ship;
      var wave1 = this.$refs.wave1;
      var wave2 = this.$refs.wave2;

      this.tl.to(wave1, 1.2, {morphSVG:wave2, ease:"power1.inOut"})
        .to(wave1, 1.2, {morphSVG:wave1, ease:"power1.inOut"});

      this.tl2.fromTo(ship, 2.4, {rotation:0, ease:"power1.inOut"}, {rotation:-8})
        .fromTo(ship, 2.4, {rotation:-8, ease:"power1.inOut"}, {rotation:0});
      } 
  },
  mounted() { 
    this.animateShip();
  },
  watch: {
    $route () {
      if (!this.tl.isActive()) {
        this.animateShip();
      }
    }
  }
}
</script>

<style scoped lang="scss">
@import "../assets/scss/main.scss";

.circle {
  border: 2px solid #D8D8D8;
  border-radius: 100%;
  height: 100px;
  margin: 0 auto;
  overflow: hidden;
  position: relative;
  width: 100px;

  /* this places circle on its own rendering layer */
  -webkit-transform:translateZ(0);
  transform:translateZ(0);
}

.ship__wrapper,
.ship-move {
  transition: transform .4s ease-out;
}

.ship__wrapper {
  position: absolute;
  -webkit-transform:translateZ(0);
  transform: translateZ(0);
  width: 100%;

  @media screen and (max-width: $break-small) {
    margin: 1rem auto;
  }
}

.ships .ship__wrapper {
  @media screen and (min-width: $break-small) {
    transform: translateX(-39%);
  }
}

.ship {
  left: 12.5%;
  position: absolute;
  top: 15%;
  width: 85%;
  
  svg, path {
    fill: #E1D4C4;
  }
}

svg {
  height: auto;
  width: 100%;
}

.waves {
  bottom: -5%;
  position: absolute;
  width: 100%;
}

.wave-2 {
  visibility: hidden;
}
</style>